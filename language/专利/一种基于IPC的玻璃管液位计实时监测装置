参考：
	http://www.innojoy.com/patent/patent.html?docno=CN201110005823.X&trsdb=fmzl&showList=true
	http://www.innojoy.com/patent/patent.html?docno=CN201510871859.4&trsdb=fmzl&showList=true
	http://www.innojoy.com/patent/patent.html?docno=CN201610531451.7&trsdb=fmzl&showList=true
	http://www.innojoy.com/patent/patent.html?docno=CN201820793392.5&trsdb=syxx&showList=true
	http://www.innojoy.com/patent/patent.html?docno=CN201610854812.1&trsdb=fmzl&showList=true
	http://www.innojoy.com/patent/patent.html?docno=CN201610592140.1&trsdb=fmzl&showList=true


摘要

权力要求书
一种基于IPC的玻璃管液位计实时监测装置，其特征在于，包括以下

说明书
	技术领域
	发明内容
	附图说明
	具体实施方案
	


	具体实施方案

	包括如下部分：红外摄像头或相机、嵌入式检测装置，包含液晶显示及触摸屏、有线无线通信接口以及控制接口等，液位检测参照背板，被检测对象。

本实例中，采用嵌入式系统，采用Linux操作系统，ARM11为主芯片，处理采集到系统中的数据。嵌入式液位检测装置人机交互采用触摸屏、彩色/黑白液晶显示屏。利用触摸屏设定预警液位高度等系统参数。利用液晶显示屏显示液位高度数值和液位变化曲线。利用有线和无线模块将采集到的图像信息传送到系统存储模块。利用有图像畸变校正算法、自适应坐标设定算法、液位线分割算法以及位置跟踪算法收集液位图像信息。使用数据滤波算法、数据整定算法、背景抑制算法取得液位图像的精确位置。

本实例中，可见光网络摄像机(IPC)硬件平台由海思Hi3516D芯片、FLASH芯片、DDR2芯片、CMOS模组、定焦镜头组成，并向外引出网络接口、RS485接口；软件平台由Hi-linux和运行在其上的IPC应用程序组成，液位算法库由IPC应用程序负责调用。CMOS图像经过IPC预处理后送入算法库，算法库通过动态检测、静态检测算法后判定出液位值。液位信息通过网络视频流、电流环、RS-485接口向外输出。

预处理过程(IPC完成)：经过CMOS坏点校正、多帧合成宽动态、空域去噪、白平衡、CCM、gamma校正、边缘锐化、3D去噪、镜头畸变校正等过程后得到画面干净、明暗分明的图像。

标定过程：开发一套标定插件，其工作流程如下：从IPC获取一幅被测液位管位于中心的静态图像，在图片上通过拖动鼠标把玻璃管液位计刻度以内的部分框定起来，称为内框，获取到内框的左上角坐标和右下角坐标保存起来；在图片上通过拖动鼠标把比玻璃管液位计稍大一些的区域框定起来，称为外框，获取到外框的左上角坐标和右下角坐标保存起来；把内框纵轴方向按照像素个数等分为指定份数，放大图片把各等分线对应的液位计刻度作为参数保存起来。以下保存起来的参数都会传给液位算法库使用。

算法过程（马彦明负责提供）：

输出过程：经过算法处理后得到液位位置，把此参数回传给IPC，IPC把液位值作为OSD叠加到视频流上，并在液位位置标注一条横线加强显示。视频流遵循RTSP网络视频流协议，方便视频上传和上云。对于每一个液位值还要向外输出一个电流环电流值或更新RS-485保持寄存器值供RS-485客户端查询。